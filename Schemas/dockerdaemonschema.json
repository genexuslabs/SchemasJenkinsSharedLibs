{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "description": "DockerDaemon.yaml schema",
    "title": "DU DockerDaemon",
    "type": "object",
    "properties": {
      "name": {
        "type": "string",
        "description": "DeploymentUnit name"
      },
      "deployType":{
        "type":"string",
        "default": "DockerDaemon",
        "description": ""
      },
      "onPrePackage":{
        "type":["string","null"],
        "description": "Relative file path to <extensibility>.groovy from git repo root with method onPreDeploy"
      },
      "customSyncPath":{
        "type":["string","null"],
        "description": "Reference from the targetPath to the stashed directory"
      },
      "customGXDProj":{
        "type":["string","null"],
        "description": "Reference to a custom gxdproj file"
      },
      "applicationServer":{
        "type":"string",
        "description": "Data for GeneXus"
      },
      "includeGAM":{
        "type":"boolean",
        "description": ""
      },
      "includeGXFlow":{
        "type":"boolean",
        "description": ""
      },
      "appUpdate":{
        "type":"string",
        "enum": ["NONE", "Minor Change", "Major Change"],
        "description": ""
      },
      "enableKBN":{
        "type":"boolean",
        "description": ""
      },
      "customDockerFile":{
        "type":["string","null"],
        "enum": ["no-generate", null],
        "description": "You can use the one generated by GeneXus, reference one already created, or by placing no-generate to do a local deploy"
      },
      "urlSubdirectory":{
        "type":["string","null"],
        "description": ""
      },
      "webAppLocation":{
        "type":"string",
        "description": ""
      },
      

      "maintainers":{
        "type":"string",
        "description": "Data for GeneXus  Format: Email1,Email2,..."
      },
      "dockerBaseImage":{
        "type":"string",
        "description": "Base image for environment"
      },
      "customImageName":{
        "type":["string","null"],
        "description": "Custom name for the DockerImage"
      },
      "schedule":{
        "type":"string",
        "description": ""
      },
      "entrypoint":{
        "type":"string",
        "description": ""
      },
      "onPostPackage":{
        "type":["string","null"],
        "description": "Relative file path to <extensibility>.groovy from git repo root with method onPostPackage"
      },
      "onPostSync":{
        "type":["string","null"],
        "description": "Relative file path to <extensibility>.groovy from git repo root with method onPostPackage"
      },
      "publishType":{
        "type":["array", "null"],
        "description": "",
        "items":{
          "oneOf": [{
            "type":"object",
          "properties": {
            "name":{
              "type":["string","null"],
              "description": ""
            },
            "registryEndpoint":{
              "type":["string","null"],
              "description": ""
            },
            "credentialsId":{
              "type":["string","null"],
              "description": ""
            },
            "deployments":{
              "type":["array", "null"],
              "description": "",
              "items":{
                "type":"object",
                "properties": {
                  "id":{
                    "uniqueItems": true,
                    "type":["string","null"],
                    "description": "Uniqe"
                  },
                  "containerNode":{
                    "type":["string","null"],
                    "description": ""
                  },
                  "port":{
                    "type":["string","null"],
                    "description": ""
                  },
                  "url":{
                    "type":["string","null"],
                    "description": ""
                  },
                  "automaticDeployment":{
                  "type":["boolean","null"],
                  "description": ""
                  },
                  "databaseId":{
                    "type":["string","null"],
                    "description": ""
                  },
                  "gam": {
                    "description": "",
                    "type": ["object","null"],
                    "properties": {
                      "databaseId": {
                        "type": ["string","null"]
                      },
                      "connectionKey": {
                        "type": ["string","null"]
                      }
                    },
                      "required": ["databaseId","connectionKey"]
                  },
                  "gxflow":{
                    "description": "",
                    "type": ["object","null"],
                    "properties": {
                      "databaseId": {
                        "type": "string"
                      }
                    },
                      "required": ["databaseId"]
                  },
                  "envs":{
                    "type":["array", "null"],
                    "description": "",
                    "items":{
                      "type":"object",
                      "properties": {
                        "name":{
                          "type":["string","null"],
                          "description": ""
                        },
                        "value":{
                          "type":["string","null"],
                          "description": ""
                        }
                      },
                    "required": ["name","value"],
                    "minItems": 1
                      }
                    }
                },
                  "required": ["id","containerNode","port","url","automaticDeployment","envs","gxflow","gam","databaseId"],
                  "minItems": 1
              }
            }
          },
            "required": ["name","registryEndpoint","credentialsId","deployments"],
            "minItems": 1
          },{
            "type": "object",
            "properties": {
              "name": {"type": "string"},
              "registryEndpoint": {"type": "string"},
              "registryImageName": {"type": "string"},
              "awsProfile": {"type": "string"}
            },
            "required": ["name", "registryEndpoint", "registryImageName", "awsProfile"]
          }]
          
        }
      }
    },
    "required": ["name","deployType","onPrePackage","customSyncPath","customGXDProj","applicationServer","includeGAM","includeGXFlow","appUpdate","enableKBN","customDockerFile","urlSubdirectory","maintainers","dockerBaseImage","customImageName","onPostPackage","publishType","onPostSync"],
    
    "if":{
      "properties": { "deployType": { "const": "DockerDaemon" } }
    },"then":{
      "required": ["entrypoint","schedule","webAppLocation"]
      }
  }
  